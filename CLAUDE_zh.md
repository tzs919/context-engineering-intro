### 🔄 项目感知与上下文
- **在新会话开始时务必阅读 `PLANNING.md`**,以了解项目的架构、目标、风格和约束。
- **在开始新任务前检查 `TASK.md`**。如果任务未列出,添加简要描述和今天的日期。
- **使用一致的命名约定、文件结构和架构模式**,如 `PLANNING.md` 中所述。
- **使用 venv_linux**(虚拟环境)执行所有 Python 命令,包括单元测试。

### 🧱 代码结构与模块化
- **永远不要创建超过500行代码的文件。** 如果文件接近此限制,通过拆分为模块或辅助文件进行重构。
- **将代码组织成清晰分离的模块**,按功能或职责分组。
  对于 agent 来说这看起来像:
    - `agent.py` - 主 agent 定义和执行逻辑
    - `tools.py` - agent 使用的工具函数
    - `prompts.py` - 系统提示词
- **使用清晰、一致的导入**(在包内优先使用相对导入)。
- **使用清晰、一致的导入**(在包内优先使用相对导入)。
- **使用 python_dotenv 和 load_env()** 处理环境变量。

### 🧪 测试与可靠性
- **始终为新功能创建 Pytest 单元测试**(函数、类、路由等)。
- **更新任何逻辑后**,检查是否需要更新现有单元测试。如果需要,立即执行。
- **测试应放在 `/tests` 文件夹中**,镜像主应用结构。
  - 至少包括:
    - 1个预期使用的测试
    - 1个边界情况
    - 1个失败情况

### ✅ 任务完成
- **在完成任务后立即在 `TASK.md` 中标记已完成的任务**。
- 将开发过程中发现的新子任务或待办事项添加到 `TASK.md` 的"开发中发现"部分。

### 📎 风格与约定
- **使用 Python** 作为主要语言。
- **遵循 PEP8**,使用类型提示,并用 `black` 格式化。
- **使用 `pydantic` 进行数据验证**。
- 如适用,使用 `FastAPI` 构建 API,使用 `SQLAlchemy` 或 `SQLModel` 作为 ORM。
- 使用 Google 风格为**每个函数编写文档字符串**:
  ```python
  def example():
      """
      简要概述。

      Args:
          param1 (type): 描述。

      Returns:
          type: 描述。
      """
  ```

### 📚 文档与可解释性
- **在添加新功能、依赖项更改或修改设置步骤时更新 `README.md`**。
- **为不明显的代码添加注释**,确保中级开发人员能够理解所有内容。
- 编写复杂逻辑时,**添加内联 `# Reason:` 注释**解释为什么这样做,而不仅仅是做了什么。

### 🧠 AI 行为规则
- **永远不要假设缺失的上下文。如果不确定就提问。**
- **永远不要虚构库或函数** – 只使用已知的、经过验证的 Python 包。
- **在代码或测试中引用之前,始终确认文件路径和模块名称**是否存在。
- **永远不要删除或覆盖现有代码**,除非明确被指示或作为 `TASK.md` 中任务的一部分。